---
title: å¹²é¥­äººã®å¤§å±æ©Ÿ
date: 2020-12-10 17:04
categories: [SpringBoot]
tags: [æŠ“åŒ…, è¯·æ±‚ä¼ªè£…]
description:
---


## 1ã€å±æ©Ÿèµ·å› 

ä»Šå¤©æ˜¯12æœˆ10å·ï¼Œè·ç¦»ç–«æƒ…å‘ç”Ÿä¸çŸ¥é“è¿‡äº†å¤šå°‘å¤©åæ­£æ€»ä¹‹å°±æ˜¯å¾ˆå¤šå¤©éƒ½å®ƒå–µå¿«ä¸€å¹´äº†çš„ä¸€å¤©ã€‚

å…¬å¸è‡ªä»å¤å·¥åä¾ç„¶åœ¨æ‰§è¡Œåˆé¥­éœ€è¦æå‰é¢„å®šçš„åˆ¶åº¦ï¼Œè™½è¯´æ˜¯ä¸ºäº†å¤§å®¶çš„å¥åº·ç€æƒ³ï¼Œä½†æ˜¯æ¯å¤©éƒ½è¦ç­‰åˆ°æ™šä¸ŠåäºŒç‚¹ç„¶åæ‰“å¼€appè®¢é¤ï¼Œå¯¹äºæˆ‘è¿™ç§ä¸€å¤©è‡³å°‘éœ€è¦ç¡å…«-ä¹å°æ—¶çš„ç”Ÿç‰©æ¥è¯´ç®€ç›´æ˜¯ä¸€ç§æŠ˜ç£¨ã€‚

å› æ­¤æˆ‘å†³å®šå¼€å§‹`é‚£ä¸ªè®¡åˆ’ï¼`ï¼ˆä¸»è¦æ˜¯åŸæ¥è®¡åˆ’è¿‡ç„¶åå¿˜äº†æ‰§è¡Œäº†Â·Â·Â·ï¼‰ã€‚



## 2ã€å¤§è‡´æ€è·¯

- ä½¿ç”¨æŠ“åŒ…å·¥å…·å¯¹æ‰‹æœºappè¿›è¡ŒæŠ“åŒ…ï¼Œè·å–è®¢é¤å¯¹åº”çš„APIæ¥å£
- ç¼–å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡è¿›è¡Œä¼ªé€ è®¢é¤è¯·æ±‚ï¼Œå¹¶åœ¨æŒ‡å®šæ—¶é—´å‘é€
- å°†é¡¹ç›®æ‰“åŒ…æ‰”åˆ°æœåŠ¡å™¨ä¸Šè¿è¡Œ



## 3ã€è¨ˆç•«é–‹å§‹ï¼

### â‘  æŠ“åŒ…ï¼

æˆ‘ä½¿ç”¨çš„æŠ“åŒ…å·¥å…·å°±æ˜¯æ¯”è¾ƒçŸ¥åçš„`Fiddler`

![](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251720592.png)


ç›´æ¥æœç´¢å¼•æ“æœå°±å®Œäº‹äº†ï¼Œæˆ–è€…ç›´æ¥ç‚¹å‡»è¿™é‡Œçš„[å®˜ç½‘é“¾æ¥](https://www.telerik.com/fiddler)

ç„¶åä¸‹è½½å®‰è£…ï¼Œå®‰è£…ä¸€ç›´ä¸‹ä¸€æ­¥å°±å¯ä»¥



Fiddlerä¸»è¦æ˜¯ä¸€ä¸ªæŠ“Webçš„å·¥å…·ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŠ“å¤–éƒ¨è®¾å¤‡çš„è®¿é—®è¯·æ±‚ï¼Œåªä¸è¿‡éœ€è¦`è®¾ç½®ä»£ç†`

1. å…³é—­ç”µè„‘çš„é˜²ç«å¢™

   Macçš„æ¯”è¾ƒç®€å•ï¼šæ‰“å¼€`ç³»ç»Ÿä¾¿å¥½è®¾ç½®` -->`å®‰å…¨ä¸éšç§`-->`é˜²ç«å¢™`

   ç„¶åå…³é—­å°±è¡Œäº†

   ![image-20201210145237364](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251720983.png)

   Windowsçš„æˆ‘ä¹Ÿå¿˜äº†åœ¨å“ªäº†ï¼Œåæ­£æ‰¾ä¸åˆ°å°±å»æœä¸€ä¸‹



2. æ‰“å¼€`Fiddler`æ‰¾åˆ°å³ä¸Šè§’è®¾ç½®

   ![image-20201210150139443](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251723982.png)

   ä¾æ¬¡æ˜¯ å…è®¸æƒé™ã€æ•è·HTTPSè¯·æ±‚ã€å¿½ç•¥è¯·æ±‚é”™è¯¯

   ç„¶åå°±æ˜¯è®¾ç½®ä»£ç†

   ![image-20201210150431171](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251726058.png)

   è®°ä½è¿™ä¸ªç«¯å£å·ï¼Œé»˜è®¤æ˜¯`8866`

   é€‰é¡¹ä¾æ¬¡æ˜¯ï¼šå¯åŠ¨æ—¶å¼€å¯ä»£ç†ã€å…è®¸å¤–éƒ¨è®¾å¤‡è®¿é—®

   è®¾ç½®å®Œæˆä¹‹åç‚¹`save`ç„¶å`é‡å¯Fiddler`ï¼Œè®°å¾—é‡å¯ï¼Œä¸ç„¶è®¾ç½®ä¸ä¼šç”Ÿæ•ˆ



3. ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ä¸ª`å±€åŸŸç½‘`ä¸‹

   ç„¶åé…ç½®æ‰‹æœºçš„ä»£ç†

    {% tabs active:1 align:center %}

    <!-- tab step 1 -->
    {% image https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251727577.PNG width:300px %}

    <!-- tab step 2 -->
    {% image https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251728376.PNG width:300px %}

    <!-- tab step 3 -->
    {% image https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251728401.PNG width:300px %}

    {% endtabs %}


   æœåŠ¡å™¨åœ°å€ä¸ºä½ çš„ç”µè„‘çš„IPåœ°å€ï¼Œç«¯å£å·å°±æ˜¯åˆšæ‰åœ¨Fiddlerä¸­è®¾ç½®çš„ç«¯å£å·äº†

   Macå¯ä»¥ç›´æ¥æ‰“å¼€ç½‘ç»œåå¥½è®¾ç½®æŸ¥çœ‹

   windoså¯ä»¥cmdè¾“å…¥

   ```bash
   ipconfig
   ```

4. æ­£å¼å¼€å§‹æŠ“åŒ…

   è¿™æ—¶å€™å¦‚æœä½ åˆ·æ–°ç½‘é¡µçš„è¯ï¼ŒFiddlerä¸­ä¼šå‡ºç°å¤§é‡è¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦å…³æ‰å¯èƒ½ä¼šå‡ºç°ç½‘ç»œè¯·æ±‚çš„ç¨‹åºã€‚ç„¶åæ‰“å¼€æ‰‹æœºapp

   ![image-20201210152620360](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251729800.png)

   è¿™æ—¶å€™å°±éœ€è¦ä½ ä»”ç»†å¯»æ‰¾äº†ï¼Œå‘ç°äº†å…¬å¸çš„æœåŠ¡å™¨IPè¯·æ±‚ï¼Œç„¶åçœ‹ä¸€ä¸‹è¯·æ±‚ç›¸åº”çš„æ•°æ®ã€‚

   æ²¡é”™ï¼Œå°±æ˜¯è¿™ä¸ªäº†ã€‚è¯è¯´é£Ÿå ‚çš„ç³–é†‹é‡Œè„ŠçœŸçš„ä¸æ€ä¹ˆæ ·

   ç„¶åå› ä¸ºè¯·æ±‚ç¡®å®å¤ªå¤šï¼Œæ·»åŠ ä¸€ä¸ªè¿‡æ»¤æ¡ä»¶è¿‡æ»¤ä¸€ä¸‹

   ![image-20201210153217264](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251729810.png)

   ç›´æ¥ä½¿ç”¨è¯·æ±‚å¤´ä¸­Hostä½œä¸ºæ¡ä»¶å³å¯



5. ç°åœ¨å°±è·å–åˆ°äº†éœ€è¦çš„è¯·æ±‚æ¥å£å’ŒHeaderä»¥åŠè´Ÿè½½çš„Bodyæ•°æ®



### â‘¡ ç¼–å†™ç¨‹åº

ç”±äºè¿™ä¸ªç¨‹åºå†™å‡ºæ¥å°±åªä¸ºäº†ç»™æˆ‘è‡ªå·±è®¢é¤ï¼Œæ‰€ä»¥åœ¨ç¼–å†™è¿‡ç¨‹ä¸­å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯ç¡¬ç¼–ç 

å‘é€è¯·æ±‚æˆ‘ä½¿ç”¨çš„æ˜¯`hutool`å·¥å…·åŒ…ä¸­å°è£…å¥½çš„`HttpRequest`ç±»

å…·ä½“ä»£ç æˆ‘å°±ä¸è´´äº†ï¼Œå› ä¸ºæ¶‰åŠå…¬å¸çš„IPåœ°å€ï¼ŒåŠappçš„æ¥å£ç­‰

ä¸è¿‡å®šæ—¶ä»»åŠ¡çš„ä»£ç å¯ä»¥è´´ä¸€ä¸‹

```java
@RestController
@Slf4j
public class OrderController {
    @Autowired
    HttpRequestService service;

    @Autowired
    private ThreadPoolTaskScheduler threadPoolTaskScheduler;

    private ScheduledFuture<?> future;

    @Bean
    public ThreadPoolTaskScheduler threadPoolTaskScheduler() {
        return new ThreadPoolTaskScheduler();
    }

    @Value("${cron.prod}")
    private String cron;


    @GetMapping("/start")
    public String start() {
        future = threadPoolTaskScheduler.schedule(new MyRunnable(service), new CronTrigger(cron));
        return "startTask";
    }

    @GetMapping("/stop")
    public String stop() {
        if (future != null) {
            future.cancel(true);
        }
        return "stopTask";
    }

}
```

ä¸»è¦æ˜¯å†™äº†ä¸¤ä¸ªæ¥å£ç”¨æ¥æ§åˆ¶å®šæ—¶ä»»åŠ¡çš„å¼€å¯å’Œå…³é—­

ç„¶ååœ¨æœ¬æœºè°ƒè¯•

![image-20201210154426589](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251729686.png)



### â‘¢ æœåŠ¡å™¨è¿è¡Œ

æƒ³è¦å®ç°åœ¨åäºŒç‚¹è®¢é¤è‚¯å®šä¸èƒ½åªè®©ç¨‹åºè¿è¡Œåœ¨æœ¬æœºç”µè„‘ä¸Šï¼Œå¦åˆ™ä½ çš„ç”µè„‘éœ€è¦æ•´æ™šå¼€æœºï¼Œæˆ–è€…ä½ å¯ä»¥è®¾ç½®å®šæ—¶å…³æœºã€‚ä½†è¿™ä¹Ÿå¤ªéº»çƒ¦äº†ï¼Œè€Œä¸”è®¢ä¸ªé¤è¿˜éœ€è¦å ç”¨åŠå…¬ç”µè„‘ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç°å®çš„ã€‚æ‰€ä»¥éœ€è¦æŠŠjaråŒ…æ‰”åˆ°æœåŠ¡å™¨ä¸Šè¿è¡Œ

å› ä¸ºåˆ›å»ºçš„é¡¹ç›®æ˜¯`SpringBoot`é¡¹ç›®ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ‰“Jarè¿è¡Œï¼Œæ–¹ä¾¿å¾ˆå¤š

ä½ å¯ä»¥ä¼ ç»Ÿçš„åœ¨æœ¬åœ°æŠŠJaråŒ…æ‰“åŒ…å¥½ï¼Œç„¶åä¸Šä¼ æœåŠ¡å™¨ï¼Œ`Java -Jar` è¿è¡Œ

ä¸è¿‡æˆ‘é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼Œç›´æ¥ä½¿ç”¨ä¸€ä¸ªideaä¸Šé˜¿é‡Œçš„æ’ä»¶ä¸€é”®éƒ¨ç½²

![image-20201210155105998](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251730727.png)

![image-20201210160739206](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251730509.png)

ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ˜¯

- æ–‡ä»¶è·å–æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä½ çš„é¡¹ç›®æœ€ç»ˆç¼–è¯‘å®Œæˆåçš„æ–‡ä»¶ï¼š

  - ä½ å¯ä»¥é€‰æ‹©`maven`æ„å»ºåç”Ÿæˆçš„æ–‡ä»¶ï¼Œè¿™æ—¶ä½ éœ€è¦è¾“å…¥mavenå…·ä½“çš„æ„å»ºå‘½ä»¤ï¼Œä¸€èˆ¬å°±æ˜¯`clean install`
  - æ‰‹åŠ¨æŒ‡å®šä¸Šä¼ çš„æ–‡ä»¶
  - Gradleæ‰“åŒ…ï¼Œå½“å‰æ˜¯ä¸ªmavené¡¹ç›®ï¼Œå› æ­¤ä¸å¯ä½¿ç”¨

- é€‰æ‹©ä½ è¦ä¸Šä¼ çš„æœåŠ¡å™¨å®ä¾‹

- ä¸Šä¼ åˆ°å“ªä¸ªè·¯å¾„ä¸‹

- ä¸Šä¼ å®Œæˆåéœ€è¦æ‰§è¡Œçš„å‘½ä»¤

  å…³äºè¿™ä¸ªéœ€è¦è¯´ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘çš„é¡¹ç›®æ˜¯ä¸ªjaråŒ…ï¼Œç›´æ¥ä½¿ç”¨`Java -jar`è¿è¡Œçš„è¯ï¼Œç›´æ¥å…³æ‰å‘½ä»¤è¡Œé¢æ¿å°±ä¼šåœæ­¢è¿è¡Œï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®åå°è¿è¡Œçš„å‘½ä»¤

  ```bash
  nohup java -jar xxx.jar > log.txt &
  ```

  ![image-20201210160027001](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251730558.png)

åˆ°è¿™è¿˜éœ€è¦ä½ è¿›å…¥é˜¿é‡Œäº‘çš„æ§åˆ¶å°ï¼Œæ‰¾åˆ°ä½ çš„æœåŠ¡å™¨å®ä¾‹ï¼Œæ‰“å¼€è¿™ä¸ªé¡¹ç›®æ‰€åœ¨ç«¯å£çš„è®¿é—®æƒé™

![image-20201210160626408](https://cdn.jsdelivr.net/gh/fengqianliuli/img/picgo_upload/202310251731021.png)

æœ€åï¼Œè®¿é—®ä½ çš„æœåŠ¡å™¨æ‰“å¼€å®šæ—¶ä»»åŠ¡å°±å®Œæˆäº†





## 4ã€ä½œæˆ°çµæŸ

å¹²é¥­äººå¤§è·å…¨èƒœï¼ğŸ‰ğŸ‰ğŸ‰ğŸ‰